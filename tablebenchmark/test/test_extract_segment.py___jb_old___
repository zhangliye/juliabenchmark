from pathlib import Path
import pandas as pd

import sys
lib_path = Path(__file__).parent.parent.joinpath('src').as_posix()
sys.path.append( lib_path )
import extract_segment_shp
# the machine running the code

Path(__file__).parent.parent.joinpath('src').as_posix()

gtfs_dir = base_dir.joinpath('GTFS/bus/google_transit_bronx')

frm_shape = pd.read_csv(gtfs_dir.joinpath("shapes.txt").as_posix(), dtype={'shape_id': str})
## get stop ids of shape
frm_stop_time = pd.read_csv(gtfs_dir.joinpath("stop_times.txt").as_posix(), dtype={'stop_id': str, 'shape_id': str})
frm_trip = pd.read_csv(gtfs_dir.joinpath("trips.txt").as_posix(), dtype={'trip_id': str, 'shape_id': str})
frm_stop = pd.read_csv(gtfs_dir.joinpath("stops.txt").as_posix(), dtype={'stop_id': str})

segements = extract_segment_shp.extract_segment(frm_trip, frm_stop, frm_stop_time, frm_shape)
i = 0
for k, v in segements.items():
    i +=1
    print(i)
    print(k)
    print(v)
